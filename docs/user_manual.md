# 기업 메시징 중계 서버 스팸 필터 시스템 사용자 매뉴얼

## 목차
1. [소개](#1-소개)
2. [시스템 접근](#2-시스템-접근)
3. [관리자 대시보드](#3-관리자-대시보드)
4. [스팸 필터 관리](#4-스팸-필터-관리)
5. [로그 및 통계](#5-로그-및-통계)
6. [시스템 설정](#6-시스템-설정)
7. [API 사용 가이드](#7-api-사용-가이드)
8. [문제 해결](#8-문제-해결)

## 1. 소개

### 1.1 시스템 개요
기업 메시징 중계 서버 스팸 필터 시스템은 기업 사용자와 이통3사(SKT, KT, LG U+) 간의 SMS 및 RCS 메시징 서비스에서 스팸 메시지를 효과적으로 필터링하기 위한 시스템입니다. 본 시스템은 머신러닝 기반의 스팸 탐지 알고리즘과 키워드 및 패턴 기반의 필터링 기능을 제공하여 불법 광고, 피싱, 스미싱 등의 유해 메시지로부터 최종 사용자를 보호합니다.

### 1.2 주요 기능
- SMS 및 RCS 메시지 실시간 스팸 필터링
- 머신러닝 기반 스팸 탐지 알고리즘
- 키워드 및 패턴 기반 필터링
- 발신번호 블랙리스트 관리
- 스팸 탐지 로그 및 통계 대시보드
- 관리자 설정 인터페이스
- API 연동 지원

### 1.3 사용자 역할
- **시스템 관리자**: 시스템 전체 설정 및 관리
- **필터 관리자**: 스팸 필터 규칙 관리
- **모니터링 담당자**: 로그 및 통계 모니터링
- **API 사용자**: API를 통한 시스템 연동

## 2. 시스템 접근

### 2.1 로그인
1. 웹 브라우저에서 관리자 웹 인터페이스 URL에 접속합니다: `http://your-server:3000/admin`
2. 관리자 계정 정보를 입력하여 로그인합니다.
   - 사용자 이름: 관리자 계정 이름
   - 비밀번호: 관리자 계정 비밀번호

![로그인 화면](images/login.png)

### 2.2 비밀번호 변경
1. 로그인 후 우측 상단의 사용자 아이콘을 클릭합니다.
2. 드롭다운 메뉴에서 "계정 설정"을 선택합니다.
3. "비밀번호 변경" 탭을 선택합니다.
4. 현재 비밀번호와 새 비밀번호를 입력하고 "저장" 버튼을 클릭합니다.

### 2.3 로그아웃
1. 우측 상단의 사용자 아이콘을 클릭합니다.
2. 드롭다운 메뉴에서 "로그아웃"을 선택합니다.

## 3. 관리자 대시보드

### 3.1 대시보드 개요
관리자 대시보드는 시스템의 주요 정보와 통계를 한눈에 볼 수 있는 화면입니다. 대시보드에서는 다음과 같은 정보를 확인할 수 있습니다:

- 실시간 메시지 처리 현황
- 스팸 탐지 통계
- 시스템 상태
- 최근 스팸 탐지 로그
- 알림 및 경고

![관리자 대시보드](images/dashboard.png)

### 3.2 위젯 설정
1. 대시보드 우측 상단의 "위젯 설정" 버튼을 클릭합니다.
2. 원하는 위젯을 선택하여 추가하거나 제거합니다.
3. 위젯의 크기와 위치를 드래그하여 조정합니다.
4. "저장" 버튼을 클릭하여 설정을 저장합니다.

### 3.3 대시보드 새로고침
- 대시보드는 기본적으로 30초마다 자동으로 새로고침됩니다.
- 수동으로 새로고침하려면 우측 상단의 "새로고침" 버튼을 클릭합니다.

## 4. 스팸 필터 관리

### 4.1 스팸 필터 규칙 관리
스팸 필터 규칙은 다음과 같은 유형으로 구분됩니다:

- **키워드 필터**: 특정 키워드가 포함된 메시지를 필터링
- **패턴 필터**: 정규식 패턴에 매칭되는 메시지를 필터링
- **발신번호 블랙리스트**: 특정 발신번호에서 오는 메시지를 필터링
- **머신러닝 모델**: 학습된 모델을 기반으로 스팸 여부를 판단

#### 4.1.1 키워드 필터 관리
1. 좌측 메뉴에서 "스팸 필터 관리" > "키워드 필터"를 선택합니다.
2. 키워드 목록을 확인하고 필요에 따라 추가, 수정, 삭제합니다.
   - 키워드 추가: "키워드 추가" 버튼을 클릭하고 키워드와 설명을 입력합니다.
   - 키워드 수정: 해당 키워드의 "수정" 버튼을 클릭하고 정보를 수정합니다.
   - 키워드 삭제: 해당 키워드의 "삭제" 버튼을 클릭합니다.
3. 키워드 가중치를 설정하여 스팸 점수에 미치는 영향을 조정할 수 있습니다.

![키워드 필터 관리](images/keyword_filter.png)

#### 4.1.2 패턴 필터 관리
1. 좌측 메뉴에서 "스팸 필터 관리" > "패턴 필터"를 선택합니다.
2. 패턴 목록을 확인하고 필요에 따라 추가, 수정, 삭제합니다.
   - 패턴 추가: "패턴 추가" 버튼을 클릭하고 정규식 패턴과 설명을 입력합니다.
   - 패턴 수정: 해당 패턴의 "수정" 버튼을 클릭하고 정보를 수정합니다.
   - 패턴 삭제: 해당 패턴의 "삭제" 버튼을 클릭합니다.
3. 패턴 가중치를 설정하여 스팸 점수에 미치는 영향을 조정할 수 있습니다.

#### 4.1.3 발신번호 블랙리스트 관리
1. 좌측 메뉴에서 "스팸 필터 관리" > "발신번호 블랙리스트"를 선택합니다.
2. 블랙리스트 목록을 확인하고 필요에 따라 추가, 수정, 삭제합니다.
   - 발신번호 추가: "발신번호 추가" 버튼을 클릭하고 발신번호와 설명을 입력합니다.
   - 발신번호 수정: 해당 발신번호의 "수정" 버튼을 클릭하고 정보를 수정합니다.
   - 발신번호 삭제: 해당 발신번호의 "삭제" 버튼을 클릭합니다.
3. 블랙리스트 기간을 설정하여 일시적 또는 영구적으로 차단할 수 있습니다.

### 4.2 머신러닝 모델 관리
1. 좌측 메뉴에서 "스팸 필터 관리" > "머신러닝 모델"을 선택합니다.
2. 현재 사용 중인 모델 정보를 확인합니다.
   - 모델 이름
   - 모델 버전
   - 학습 일자
   - 정확도, 정밀도, 재현율 등의 성능 지표
3. 모델 재학습을 위해 "모델 재학습" 버튼을 클릭합니다.
4. 모델 가중치를 설정하여 전체 스팸 판단에 미치는 영향을 조정할 수 있습니다.

![머신러닝 모델 관리](images/ml_model.png)

### 4.3 스팸 필터 테스트
1. 좌측 메뉴에서 "스팸 필터 관리" > "필터 테스트"를 선택합니다.
2. 테스트할 메시지 내용과 발신번호를 입력합니다.
3. "테스트" 버튼을 클릭하여 스팸 필터 결과를 확인합니다.
4. 결과 화면에서는 다음 정보를 확인할 수 있습니다:
   - 스팸 여부 판단 결과
   - 스팸 점수
   - 각 필터별 기여도
   - 탐지된 키워드 또는 패턴

## 5. 로그 및 통계

### 5.1 스팸 탐지 로그
1. 좌측 메뉴에서 "로그 및 통계" > "스팸 탐지 로그"를 선택합니다.
2. 로그 목록에서 다음 정보를 확인할 수 있습니다:
   - 탐지 일시
   - 메시지 ID
   - 발신번호
   - 수신번호
   - 스팸 점수
   - 처리 결과
3. 특정 로그를 클릭하면 상세 정보를 확인할 수 있습니다:
   - 메시지 내용
   - 탐지된 키워드 또는 패턴
   - 각 필터별 기여도
   - 처리 시간

![스팸 탐지 로그](images/spam_log.png)

### 5.2 통계 분석
1. 좌측 메뉴에서 "로그 및 통계" > "통계 분석"을 선택합니다.
2. 다양한 통계 정보를 확인할 수 있습니다:
   - 일별/주별/월별 스팸 탐지 건수
   - 스팸 유형별 분포
   - 시간대별 스팸 발생 추이
   - 발신번호별 스팸 발생 빈도
   - 필터별 탐지 효과
3. 통계 기간을 설정하여 원하는 기간의 통계를 확인할 수 있습니다.
4. 통계 데이터는 그래프와 표 형태로 제공됩니다.
5. "내보내기" 버튼을 클릭하여 통계 데이터를 CSV 또는 Excel 형식으로 다운로드할 수 있습니다.

### 5.3 보고서 생성
1. 좌측 메뉴에서 "로그 및 통계" > "보고서 생성"을 선택합니다.
2. 보고서 유형을 선택합니다:
   - 일일 보고서
   - 주간 보고서
   - 월간 보고서
   - 커스텀 보고서
3. 보고서 기간과 포함할 내용을 설정합니다.
4. "보고서 생성" 버튼을 클릭하여 보고서를 생성합니다.
5. 생성된 보고서는 PDF 또는 Excel 형식으로 다운로드할 수 있습니다.
6. "예약 설정" 버튼을 클릭하여 정기적인 보고서 생성을 예약할 수 있습니다.

## 6. 시스템 설정

### 6.1 일반 설정
1. 좌측 메뉴에서 "시스템 설정" > "일반 설정"을 선택합니다.
2. 다음 항목을 설정할 수 있습니다:
   - 스팸 판단 임계값: 스팸으로 판단할 점수 기준 (0.0 ~ 1.0)
   - 처리 정책: 스팸으로 판단된 메시지에 대한 처리 방법 (차단, 태그 추가, 로깅 등)
   - 로그 보관 기간: 스팸 탐지 로그를 보관할 기간
   - 통지 설정: 중요 이벤트 발생 시 관리자에게 통지할 방법 (이메일, SMS 등)

![일반 설정](images/general_settings.png)

### 6.2 사용자 관리
1. 좌측 메뉴에서 "시스템 설정" > "사용자 관리"를 선택합니다.
2. 사용자 목록을 확인하고 필요에 따라 추가, 수정, 삭제합니다:
   - 사용자 추가: "사용자 추가" 버튼을 클릭하고 사용자 정보와 역할을 입력합니다.
   - 사용자 수정: 해당 사용자의 "수정" 버튼을 클릭하고 정보를 수정합니다.
   - 사용자 삭제: 해당 사용자의 "삭제" 버튼을 클릭합니다.
3. 사용자 역할을 설정하여 접근 권한을 관리할 수 있습니다:
   - 시스템 관리자: 모든 기능에 접근 가능
   - 필터 관리자: 스팸 필터 관리 기능에 접근 가능
   - 모니터링 담당자: 로그 및 통계 기능에 접근 가능
   - API 사용자: API 연동 기능에 접근 가능

### 6.3 API 설정
1. 좌측 메뉴에서 "시스템 설정" > "API 설정"을 선택합니다.
2. API 키를 관리할 수 있습니다:
   - API 키 생성: "API 키 생성" 버튼을 클릭하고 설명과 권한을 입력합니다.
   - API 키 재발급: 해당 API 키의 "재발급" 버튼을 클릭합니다.
   - API 키 삭제: 해당 API 키의 "삭제" 버튼을 클릭합니다.
3. API 접근 제한을 설정할 수 있습니다:
   - IP 주소 제한: 특정 IP 주소 또는 범위에서만 API 접근 허용
   - 요청 제한: 시간당 최대 요청 수 제한
   - 기능 제한: 특정 API 엔드포인트에 대한 접근 제한

### 6.4 백업 및 복원
1. 좌측 메뉴에서 "시스템 설정" > "백업 및 복원"을 선택합니다.
2. 백업을 생성할 수 있습니다:
   - "백업 생성" 버튼을 클릭하여 시스템 설정과 데이터의 백업을 생성합니다.
   - 백업 범위를 선택할 수 있습니다: 전체, 설정만, 데이터만
3. 백업 목록에서 기존 백업을 관리할 수 있습니다:
   - 백업 다운로드: 해당 백업의 "다운로드" 버튼을 클릭합니다.
   - 백업 복원: 해당 백업의 "복원" 버튼을 클릭합니다.
   - 백업 삭제: 해당 백업의 "삭제" 버튼을 클릭합니다.
4. 자동 백업을 설정할 수 있습니다:
   - 백업 주기: 일별, 주별, 월별
   - 백업 시간: 백업을 수행할 시간
   - 보관 기간: 백업 파일을 보관할 기간

## 7. API 사용 가이드

### 7.1 API 개요
스팸 필터 시스템은 RESTful API를 통해 외부 시스템과 연동할 수 있습니다. API를 통해 다음과 같은 기능을 사용할 수 있습니다:

- 메시지 스팸 검사
- 스팸 필터 규칙 관리
- 스팸 탐지 로그 조회
- 통계 데이터 조회

### 7.2 인증 및 권한
API 사용을 위해서는 API 키가 필요합니다. API 키는 관리자 웹 인터페이스의 "시스템 설정" > "API 설정"에서 생성할 수 있습니다.

API 요청 시 다음과 같이 인증 정보를 포함해야 합니다:
```
Authorization: Bearer YOUR_API_KEY
```

### 7.3 주요 API 엔드포인트

#### 7.3.1 메시지 스팸 검사
```
POST /api/v1/spam/check
```

요청 예시:
```json
{
  "sender": "01012345678",
  "recipient": "01087654321",
  "message": "안녕하세요. 이것은 테스트 메시지입니다.",
  "message_type": "SMS"
}
```

응답 예시:
```json
{
  "is_spam": false,
  "spam_score": 0.15,
  "details": {
    "keyword_filter": 0.1,
    "pattern_filter": 0.0,
    "blacklist": 0.0,
    "ml_model": 0.2
  },
  "detected_patterns": [],
  "processing_time": 0.05
}
```

#### 7.3.2 스팸 필터 규칙 조회
```
GET /api/v1/spam/rules
```

응답 예시:
```json
{
  "keyword_filters": [
    {
      "id": 1,
      "keyword": "무료",
      "weight": 0.5,
      "description": "무료 광고 키워드"
    },
    ...
  ],
  "pattern_filters": [
    {
      "id": 1,
      "pattern": "\\d{6}",
      "weight": 0.7,
      "description": "6자리 숫자 패턴"
    },
    ...
  ],
  "blacklist": [
    {
      "id": 1,
      "sender": "01012345678",
      "expires_at": "2023-12-31T23:59:59Z",
      "description": "스팸 발신자"
    },
    ...
  ]
}
```

#### 7.3.3 스팸 탐지 로그 조회
```
GET /api/v1/spam/logs
```

쿼리 파라미터:
- `start_date`: 시작 날짜 (YYYY-MM-DD)
- `end_date`: 종료 날짜 (YYYY-MM-DD)
- `is_spam`: 스팸 여부 (true/false)
- `page`: 페이지 번호
- `limit`: 페이지당 항목 수

응답 예시:
```json
{
  "total": 1250,
  "page": 1,
  "limit": 10,
  "logs": [
    {
      "id": 12345,
      "timestamp": "2023-06-01T12:34:56Z",
      "sender": "01012345678",
      "recipient": "01087654321",
      "message_type": "SMS",
      "is_spam": true,
      "spam_score": 0.85,
      "action": "blocked"
    },
    ...
  ]
}
```

### 7.4 API 사용 예시 (Python)
```python
import requests
import json

API_URL = "http://your-server:8000/api/v1"
API_KEY = "your-api-key"

headers = {
    "Authorization": f"Bearer {API_KEY}",
    "Content-Type": "application/json"
}

# 메시지 스팸 검사
def check_spam(sender, recipient, message, message_type="SMS"):
    url = f"{API_URL}/spam/check"
    payload = {
        "sender": sender,
        "recipient": recipient,
        "message": message,
        "message_type": message_type
    }
    response = requests.post(url, headers=headers, data=json.dumps(payload))
    return response.json()

# 스팸 필터 규칙 조회
def get_spam_rules():
    url = f"{API_URL}/spam/rules"
    response = requests.get(url, headers=headers)
    return response.json()

# 스팸 탐지 로그 조회
def get_spam_logs(start_date, end_date, is_spam=None, page=1, limit=10):
    url = f"{API_URL}/spam/logs"
    params = {
        "start_date": start_date,
        "end_date": end_date,
        "page": page,
        "limit": limit
    }
    if is_spam is not None:
        params["is_spam"] = is_spam
    response = requests.get(url, headers=headers, params=params)
    return response.json()

# 사용 예시
result = check_spam("01012345678", "01087654321", "안녕하세요. 이것은 테스트 메시지입니다.")
print(f"스팸 여부: {result['is_spam']}")
print(f"스팸 점수: {result['spam_score']}")
```

## 8. 문제 해결

### 8.1 자주 발생하는 문제
1. **로그인 실패**
   - 사용자 이름과 비밀번호를 정확히 입력했는지 확인합니다.
   - 계정이 잠겨있는 경우 관리자에게 문의합니다.

2. **스팸 필터 규칙이 적용되지 않음**
   - 규칙이 올바르게 저장되었는지 확인합니다.
   - 시스템 로그를 확인하여 오류 메시지가 있는지 확인합니다.
   - 규칙의 우선순위와 가중치를 확인합니다.

3. **API 연동 오류**
   - API 키가 유효한지 확인합니다.
   - API 요청 형식이 올바른지 확인합니다.
   - IP 주소 제한이 설정되어 있는 경우 허용된 IP에서 요청하는지 확인합니다.

4. **시스템 성능 저하**
   - 시스템 리소스 사용량을 확인합니다.
   - 데이터베이스 성능을 확인합니다.
   - 로그 파일 크기를 확인하고 필요한 경우 로그 로테이션을 설정합니다.

### 8.2 지원 및 문의
시스템 사용 중 문제가 발생하거나 추가 지원이 필요한 경우 다음 연락처로 문의하세요:

- **이메일**: support@example.com
- **전화**: 02-123-4567
- **지원 포털**: https://support.example.com

지원 요청 시 다음 정보를 함께 제공하면 빠른 해결에 도움이 됩니다:
- 문제 발생 시간
- 문제 상세 내용
- 오류 메시지 또는 스크린샷
- 시스템 버전 정보 